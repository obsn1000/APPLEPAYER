<!DOCTYPE html><html><head><meta charSet="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="description" content="ApplePaySDK Demo - Simulate Apple Pay, generate K/BAN codes, and download mobile configurations"/><title>Apple Pay Demo</title><style>
          :root {
            --primary-color: #000;
            --secondary-color: #333;
            --accent-color: #0070c9;
            --success-color: #34c759;
            --error-color: #ff3b30;
            --text-color: #fff;
            --background-color: #f5f5f7;
          }
          
          body {
            font-family: -apple-system, BlinkMacSystemFont, &#x27;Segoe UI&#x27;, Roboto, Oxygen, Ubuntu, Cantarell, &#x27;Open Sans&#x27;, &#x27;Helvetica Neue&#x27;, sans-serif;
            text-align: center;
            padding: 50px 20px;
            margin: 0;
            background-color: var(--background-color);
            color: var(--secondary-color);
            line-height: 1.5;
          }
          
          .container {
            max-width: 800px;
            margin: 0 auto;
          }
          
          .button {
            font-size: 18px;
            padding: 15px 30px;
            background-color: var(--primary-color);
            color: var(--text-color);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin: 10px;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
          }
          
          .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
          }
          
          .button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
          }
          
          .button:focus {
            outline: 2px solid var(--accent-color);
            outline-offset: 2px;
          }
          
          .button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
          }
          
          .button img {
            height: 24px;
            margin-right: 10px;
          }
          
          .input-section {
            margin: 30px 0;
            padding: 25px;
            background-color: white;
            border-radius: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
          }
          
          .input-section h2 {
            margin-bottom: 15px;
            color: var(--secondary-color);
            font-size: 20px;
            font-weight: 500;
          }
          
          .input-container {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
          }
          
          .pass-input {
            flex: 1;
            min-width: 300px;
            padding: 15px 20px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background-color: #fafafa;
            transition: all 0.2s ease;
            font-family: monospace;
          }
          
          .pass-input:focus {
            outline: none;
            border-color: var(--accent-color);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(0, 112, 201, 0.1);
          }
          
          .pass-input::placeholder {
            color: #999;
            font-family: -apple-system, BlinkMacSystemFont, &#x27;Segoe UI&#x27;, Roboto, Oxygen, Ubuntu, Cantarell, &#x27;Open Sans&#x27;, &#x27;Helvetica Neue&#x27;, sans-serif;
          }

          .button-container {
            margin-top: 30px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
          }
          
          h1 {
            margin-bottom: 20px;
            font-weight: 600;
          }
          
          .result {
            margin-top: 30px;
            padding: 20px;
            border-radius: 10px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            min-height: 60px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
          }
          
          .result.success {
            border-left: 5px solid var(--success-color);
          }
          
          .result.error {
            border-left: 5px solid var(--error-color);
          }
          
          .hidden {
            display: none;
          }
          
          .spinner {
            width: 24px;
            height: 24px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--accent-color);
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
          }
          
          @keyframes spin {
            to { transform: rotate(360deg); }
          }
          
          .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 8px;
            background-color: var(--primary-color);
            color: var(--text-color);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 1000;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
          }
          
          .notification.show {
            opacity: 1;
            transform: translateY(0);
          }
          
          .notification.success {
            background-color: var(--success-color);
          }
          
          .notification.error {
            background-color: var(--error-color);
          }
          
          @media (max-width: 600px) {
            .button-container {
              flex-direction: column;
              align-items: center;
            }
            
            .button {
              width: 100%;
              max-width: 300px;
            }
          }
        </style><meta name="next-head-count" content="5"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-69bfa6990bb9e155.js" defer=""></script><script src="/_next/static/chunks/framework-5f4595e5518b5600.js" defer=""></script><script src="/_next/static/chunks/main-5231dfecb738efdd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-dc14f8483464b560.js" defer=""></script><script src="/_next/static/chunks/pages/index-82ebab879870c8ec.js" defer=""></script><script src="/_next/static/DiGGGCJZSJuxdoFPush9z/_buildManifest.js" defer=""></script><script src="/_next/static/DiGGGCJZSJuxdoFPush9z/_ssgManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="container"><h1>ApplePaySDK Demo</h1><div class="input-section"><h2>Enter Pass from Reapware</h2><div class="input-container"><input type="text" id="reapware-pass-input" placeholder="Paste your pass/code from reapware here..." class="pass-input"/><button id="process-pass-button" class="button" aria-label="Process reapware pass"><span aria-hidden="true">‚ö°</span> Process Pass</button></div></div><div class="button-container"><button id="pay-button" class="button" aria-label="Simulate Apple Pay payment"><span aria-hidden="true">üçé</span>Simulate Apple Pay</button><button id="download-config-button" class="button" aria-label="Download mobile configuration file"><span aria-hidden="true">üì•</span> Download Mobile Config</button><button id="generate-kban-button" class="button" aria-label="Generate a new K/BAN code"><span aria-hidden="true">üîë</span> Generate K/BAN</button></div><div id="result" class="result hidden"><div id="result-content"></div><div id="result-actions" class="button-container hidden"><button id="create-pass-button" class="button" aria-label="Create Apple Wallet pass">Create Wallet Pass</button><button id="copy-kban-button" class="button" aria-label="Copy K/BAN to clipboard">Copy K/BAN</button></div></div></div><div id="notification" class="notification" role="alert"></div><script>
          // Utility functions
          function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.classList.add('show');
            
            // Remove notification after 3 seconds
            setTimeout(() => {
              notification.classList.remove('show');
            }, 3000);
          }
          
          function showResult(content, type = '') {
            const resultElement = document.getElementById('result');
            const resultContent = document.getElementById('result-content');
            
            resultContent.innerHTML = content;
            resultElement.className = `result ${type}`;
            resultElement.classList.remove('hidden');
          }
          
          function hideResult() {
            const resultElement = document.getElementById('result');
            resultElement.classList.add('hidden');
            document.getElementById('result-actions').classList.add('hidden');
          }
          
          function setButtonLoading(buttonId, isLoading) {
            const button = document.getElementById(buttonId);
            
            if (isLoading) {
              const spinner = document.createElement('div');
              spinner.className = 'spinner';
              button.prepend(spinner);
              button.disabled = true;
            } else {
              const spinner = button.querySelector('.spinner');
              if (spinner) {
                button.removeChild(spinner);
              }
              button.disabled = false;
            }
          }

          // Wait for DOM to be ready
          document.addEventListener('DOMContentLoaded', function() {
            
            // Process reapware pass
            document.getElementById('process-pass-button').addEventListener('click', async () => {
              try {
                const passInput = document.getElementById('reapware-pass-input');
                const passValue = passInput.value.trim();
                
                if (!passValue) {
                  throw new Error('Please enter a pass/code from reapware');
                }
                
                hideResult();
                setButtonLoading('process-pass-button', true);
                
                // First validate the pass
                const validateResponse = await fetch('/api/kban/validate', {
                  method: 'POST',
                  headers: { 
                    'Content-Type': 'application/json',
                    'X-API-Key': 'test_api_key_for_development'
                  },
                  body: JSON.stringify({ kban: passValue })
                });
                
                if (!validateResponse.ok) {
                  const errorData = await validateResponse.json();
                  throw new Error(errorData.error || `Validation failed with status ${validateResponse.status}`);
                }
                
                const validationData = await validateResponse.json();
                
                if (validationData.valid) {
                  showNotification('Pass validated successfully!', 'success');
                  showResult(`<h3>‚úÖ Valid Reapware Pass</h3><p><strong>Pass:</strong> ${passValue}</p><p><strong>Status:</strong> Valid and ready to use</p>`, 'success');
                  
                  // Show action buttons
                  const actionsContainer = document.getElementById('result-actions');
                  actionsContainer.classList.remove('hidden');
                  
                  // Store the pass for later use
                  window.generatedKban = passValue;
                  
                  // Clear the input
                  passInput.value = '';
                } else {
                  showNotification('Invalid pass', 'error');
                  showResult(`<h3>‚ùå Invalid Pass</h3><p>The pass you entered is not valid or has expired.</p>`, 'error');
                }
                
              } catch (error) {
                console.error('Error processing pass:', error);
                showNotification('Failed to process pass', 'error');
                showResult(`<h3>Processing Failed</h3><p>${error.message}</p>`, 'error');
              } finally {
                setButtonLoading('process-pass-button', false);
              }
            });
            
            // Allow Enter key to process pass
            document.getElementById('reapware-pass-input').addEventListener('keypress', function(event) {
              if (event.key === 'Enter') {
                document.getElementById('process-pass-button').click();
              }
            });
            // Generate K/BAN
            document.getElementById('generate-kban-button').addEventListener('click', async () => {
              try {
                hideResult();
                setButtonLoading('generate-kban-button', true);
                
                const response = await fetch('/api/kban/generate', {
                  method: 'POST',
                  headers: { 
                    'Content-Type': 'application/json',
                    'X-API-Key': 'test_api_key_for_development'
                  }
                });
                
                if (!response.ok) {
                  const errorData = await response.json();
                  throw new Error(errorData.error || `Failed with status ${response.status}`);
                }
                
                const data = await response.json();
                showNotification('K/BAN generated successfully', 'success');
                showResult(`<h3>Generated K/BAN</h3><p id="kban-value">${data.kban}</p><p>Generated at: ${data.timestamp || new Date().toISOString()}</p>`, 'success');
                
                // Show action buttons
                const actionsContainer = document.getElementById('result-actions');
                actionsContainer.classList.remove('hidden');
                
                // Store the K/BAN for later use
                window.generatedKban = data.kban;
              } catch (error) {
                console.error('Error generating K/BAN:', error);
                showNotification('Failed to generate K/BAN', 'error');
                showResult(`<h3>K/BAN Generation Failed</h3><p>${error.message}</p>`, 'error');
              } finally {
                setButtonLoading('generate-kban-button', false);
              }
            });

            // Download mobile config
            document.getElementById('download-config-button').addEventListener('click', () => {
              try {
                hideResult();
                setButtonLoading('download-config-button', true);
                
                showNotification('Downloading configuration file...', 'info');
                
                // Create an iframe to handle the download
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = '/api/generate-mobileconfig';
                document.body.appendChild(iframe);
                
                // Remove the iframe after download starts
                setTimeout(() => {
                  document.body.removeChild(iframe);
                  setButtonLoading('download-config-button', false);
                  showNotification('Download started', 'success');
                  showResult('<h3>Configuration File</h3><p>Your mobile configuration file download has started.</p>', 'success');
                }, 1000);
              } catch (error) {
                console.error('Download error:', error);
                showNotification('Download failed', 'error');
                showResult(`<h3>Download Failed</h3><p>${error.message}</p>`, 'error');
                setButtonLoading('download-config-button', false);
              }
            });

            // Create pass button
            document.getElementById('create-pass-button').addEventListener('click', async () => {
              try {
                if (!window.generatedKban) {
                  throw new Error('No K/BAN available');
                }
                
                setButtonLoading('create-pass-button', true);
                showNotification('Creating Apple Wallet pass...', 'info');
                
                // Create an iframe to handle the download
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = `/api/pass/create?kban=${window.generatedKban}`;
                document.body.appendChild(iframe);
                
                // Remove the iframe after download starts
                setTimeout(() => {
                  document.body.removeChild(iframe);
                  setButtonLoading('create-pass-button', false);
                  showNotification('Pass download started', 'success');
                }, 1000);
              } catch (error) {
                console.error('Error creating pass:', error);
                showNotification('Failed to create pass', 'error');
                setButtonLoading('create-pass-button', false);
              }
            });
            
            // Copy K/BAN button
            document.getElementById('copy-kban-button').addEventListener('click', () => {
              try {
                if (!window.generatedKban) {
                  throw new Error('No K/BAN available to copy');
                }
                
                navigator.clipboard.writeText(window.generatedKban)
                  .then(() => {
                    showNotification('K/BAN copied to clipboard', 'success');
                  })
                  .catch((error) => {
                    console.error('Clipboard error:', error);
                    showNotification('Failed to copy to clipboard', 'error');
                  });
              } catch (error) {
                showNotification(error.message, 'error');
              }
            });

            // Apple Pay simulation (simplified for demo)
            document.getElementById('pay-button').addEventListener('click', async () => {
              showNotification('Apple Pay simulation would require real certificates', 'info');
              showResult('<h3>Apple Pay Demo</h3><p>This would initiate Apple Pay in a real environment with proper certificates.</p>', 'success');
            });
          });
        </script></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{}},"page":"/","query":{},"buildId":"DiGGGCJZSJuxdoFPush9z","nextExport":true,"autoExport":true,"isFallback":false,"scriptLoader":[]}</script></body></html>